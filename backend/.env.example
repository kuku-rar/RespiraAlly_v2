# RespiraAlly V2.0 - Environment Variables Example
# Copy this file to .env and fill in your actual values
# DO NOT commit .env to version control!

# ================================
# Application Settings
# ================================
ENVIRONMENT=development  # Options: development, staging, production
DEBUG=True
APP_NAME=RespiraAlly V2.0

# ================================
# Database (PostgreSQL + pgvector)
# ================================
# Local Development (using Docker Compose):
DATABASE_URL=postgresql+asyncpg://admin:admin@localhost:15432/respirally_db  # Port 15432 to avoid conflicts

# Zeabur Deployment (Auto-injected):
# Zeabur will automatically inject DATABASE_URL from PostgreSQL service binding
# Format: postgresql://user:password@host:port/database
# NOTE: Change 'postgresql://' to 'postgresql+asyncpg://' in config.py for async support

DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_ECHO=False

# ================================
# Redis Cache
# ================================
# Local Development (using Docker Compose):
REDIS_HOST=localhost
REDIS_PORT=16379  # Port 16379 to avoid conflicts (Docker maps 16379:6379)
REDIS_DB=0
REDIS_PASSWORD=

# Zeabur Deployment (Auto-injected):
# Zeabur will inject REDIS_URL (redis://host:port)
# Our config uses REDIS_HOST/PORT, so parse REDIS_URL in config.py if present

# ================================
# RabbitMQ Message Broker (Phase 2)
# ================================
RABBITMQ_HOST=localhost
RABBITMQ_PORT=5672
RABBITMQ_USER=guest
RABBITMQ_PASSWORD=guest

# ================================
# JWT Authentication
# ================================
# CRITICAL: Must use a secure random string in production!
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
#
# Development (for local testing only):
JWT_SECRET_KEY=dev-only-insecure-key-CHANGE-IN-PRODUCTION-abc123

# Production (Zeabur):
# Set as environment variable in Zeabur dashboard
# Example: JWT_SECRET_KEY=XyZ9_aBc...random_32_bytes
#
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=480  # 8 hours (as per JWT design doc)
REFRESH_TOKEN_EXPIRE_DAYS=30     # 30 days (as per JWT design doc)

# ================================
# CORS Configuration
# ================================
# Local Development:
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# Zeabur Production:
# Update to your actual frontend domains
# Example: CORS_ORIGINS=https://dashboard.respirally.app,https://liff.respirally.app

# ================================
# LINE Platform
# ================================
# Get these from LINE Developers Console: https://developers.line.biz/console/
LINE_CHANNEL_ACCESS_TOKEN=your-line-channel-access-token
LINE_CHANNEL_SECRET=your-line-channel-secret
LINE_LIFF_ID=your-liff-app-id

# ================================
# OpenAI (GPT-4 for RAG)
# ================================
# Get API key from: https://platform.openai.com/api-keys
OPENAI_API_KEY=your-openai-api-key
OPENAI_MODEL=gpt-4-turbo-preview
OPENAI_TEMPERATURE=0.7
OPENAI_MAX_TOKENS=1000

# ================================
# LangChain (Optional - for RAG tracing)
# ================================
LANGCHAIN_TRACING_V2=False
LANGCHAIN_API_KEY=

# ================================
# Vector Search (pgvector)
# ================================
VECTOR_DIMENSION=1536
SIMILARITY_THRESHOLD=0.7

# ================================
# Logging
# ================================
LOG_LEVEL=INFO
LOG_FORMAT=json

# ================================================================================
# ðŸš€ Zeabur Deployment Guide
# ================================================================================
#
# 1. Create PostgreSQL Service in Zeabur:
#    - Service Type: PostgreSQL 15+ (with pgvector extension)
#    - Zeabur will auto-inject: DATABASE_URL
#
# 2. Create Redis Service in Zeabur:
#    - Service Type: Redis 7+
#    - Zeabur will auto-inject: REDIS_URL
#
# 3. Set Environment Variables in Zeabur Dashboard:
#    Required:
#    - ENVIRONMENT=production
#    - DEBUG=False
#    - JWT_SECRET_KEY=<generate-with-secrets.token_urlsafe(32)>
#    - LINE_CHANNEL_ACCESS_TOKEN=<from-LINE-console>
#    - LINE_CHANNEL_SECRET=<from-LINE-console>
#    - LINE_LIFF_ID=<from-LINE-console>
#    - OPENAI_API_KEY=<from-OpenAI>
#    - CORS_ORIGINS=https://your-dashboard.zeabur.app,https://your-liff.zeabur.app
#
#    Optional (use defaults if not set):
#    - ACCESS_TOKEN_EXPIRE_MINUTES=480
#    - REFRESH_TOKEN_EXPIRE_DAYS=30
#    - DB_POOL_SIZE=10
#    - LOG_LEVEL=INFO
#
# 4. Database Migrations:
#    After first deployment, run in Zeabur terminal:
#    $ uv run alembic upgrade head
#
# 5. Health Check:
#    Test endpoint: https://your-app.zeabur.app/health
#
# ================================================================================
